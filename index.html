
<!DOCTYPE html>
<html lang="vi">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>ğŸ“Š Bá»™ cÃ´ng cá»¥ thá»‘ng kÃª</title>

<style>
  /* ====== Global theme & layout ====== */

 /* ====== Global theme & layout ====== */
  :root{
    --bg:#f7f9fb;
    --panel:#ffffff;
    --primary:#14b8a6;
    --primary-600:#0d9488;
    --muted:#6b7280;
    --shadow: 0 8px 24px rgba(2,6,23,0.08);
    --btn-radius:12px;
  }

  body{font-family:"Segoe UI", Roboto, "Times New Roman", serif; background:var(--bg); margin:0; padding:28px; color:#0f172a;}
  h1{margin:0 0 10px;font-size:24px;color:var(--primary-600);text-align:center}
  .topbar{display:flex;justify-content:center;gap:12px;margin-bottom:18px;flex-wrap:wrap}
  .nav-btn{background:var(--primary); color:white; border:none; padding:12px 18px; border-radius:var(--btn-radius); cursor:pointer; font-weight:700; box-shadow:var(--shadow); transition:transform .18s, box-shadow .18s;}
  /* hover: lift and subtle shake */
  @keyframes hover-shake {
    0% { transform: translateY(-4px) rotate(0deg); }
    30% { transform: translateY(-6px) rotate(-1deg); }
    60% { transform: translateY(-6px) rotate(1deg); }
    100% { transform: translateY(-4px) rotate(0deg); }
  }
  .nav-btn:hover{ animation: hover-shake .45s ease; box-shadow: 0 14px 30px rgba(2,6,23,0.12); }

  /* container for views */
  .view{ display:none; background:var(--panel); padding:18px; border-radius:14px; box-shadow:var(--shadow); max-width:1100px; margin:0 auto 28px; }
  .view.active{ display:block; }

  /* common small styles */
  .btn { padding:10px 16px; border-radius:10px; border:0; cursor:pointer; font-weight:700; box-shadow:0 8px 20px rgba(2,6,23,0.06); }
  .btn:active{ transform: translateY(2px); }
  .btn-add{ background:#0ea5a0; color:#fff; }
  .btn-calc{ background:#22c55e; color:#fff; }
  .btn-reset{ background:#ef4444; color:#fff; }

  table{ width:100%; border-collapse:collapse; margin-top:12px; background: #fff; border-radius:10px; overflow:hidden; box-shadow: 0 6px 18px rgba(2,6,23,0.04); }
  th,td{ padding:8px 10px; border:1px solid rgba(0,0,0,0.06); text-align:center; }
  th{ background: #dff6f1; color:var(--primary-600); font-weight:700; }
  input[type="number"], input[type="text"]{ padding:6px;border-radius:6px;border:1px solid #ccc; width:100%; text-align:center; box-sizing:border-box; }

  
 
.container-cols .col {
  flex: 0 0 calc(50% - 22px);
}.container-cols {
    display: flex;
    gap: 22px;
    margin-top: 16px;
    flex-wrap: wrap; /* náº¿u muá»‘n xuá»‘ng dÃ²ng khi khÃ´ng Ä‘á»§ chá»— */
}

.container-cols > div {
  border: 2px solid #ccc;
  padding: 12px;
  border-radius: 8px;
}

  .card{ flex:1; min-width:260px; background:#fff;padding:14px;border-radius:10px; box-shadow: 0 3px 10px rgba(2,6,23,0.04); }
  .formula h3, .output h3{ margin:6px 0 10px;color:#0f4ea8; }
  .output p{ margin:6px 0; }

  /* small animations */
  .show{ opacity:1; transform:none; transition:all .45s ease; }
  .hide{ opacity:0; transform:translateY(10px); transition:all .25s ease; }

  /* shake for invalid */
  @keyframes shake { 0%{transform:translateX(0)} 20%{transform:translateX(-6px)} 40%{transform:translateX(6px)} 60%{transform:translateX(-4px)} 80%{transform:translateX(4px)} 100%{transform:translateX(0)} }
  .shake{ animation:shake .36s ease; border-color:#ef4444 !important; }

  pre.small { background:#f1f6f5; padding:8px; border-radius:8px; overflow:auto; font-size:13px; }

  /* Responsive */
  @media(max-width:900px){
    .container-cols{ flex-direction:column; }
  }


  /* Table */
  table { width:100%; border-collapse:collapse; margin-top:15px; background:var(--panel); border-radius:12px; overflow:hidden; box-shadow:var(--shadow); }
  th { background:var(--teal-300); color:var(--teal-600); font-weight:600; }
  th, td { border:1px solid var(--border); padding:8px; text-align:center; }
  td input { width:95%; padding:8px; border-radius:6px; border:1px solid rgba(0,0,0,0.06); background:transparent; color:inherit; }

table { border-collapse: collapse; margin-top: 10px; background: white; border-radius: 10px; overflow: hidden; }
  td, th { border: 1px solid #ccc; padding: 8px 12px; text-align: center; }
  th { background: #aef0e4; }
  input { width: 80px; text-align: center; border: 1px solid #ccc; border-radius: 4px; padding: 4px; }

  /* Result box */
  #result { margin-top:20px; background:var(--code-bg); border-left:6px solid var(--teal-600); padding:16px; border-radius:8px; font-size:16px; box-shadow:var(--shadow); }

  /* Floating toolbar */
  .floating-toolbar { position:fixed; right:18px; bottom:18px; display:flex; flex-direction:column; gap:10px; z-index:1200; }
  .toolbar-btn { width:48px; height:48px; border-radius:12px; display:flex; align-items:center; justify-content:center; background:var(--panel); border:1px solid var(--border); box-shadow:var(--shadow); cursor:pointer; transition:transform .12s,background .12s; }
  .toolbar-btn:hover{ transform:translateY(-6px); }
  .toolbar-btn svg{ width:22px; height:22px; fill:var(--teal-500); }

  /* Tooltip modern (for validation) */
  .tooltip-modern{ position:absolute; background:var(--teal-600); color:white; padding:6px 10px; border-radius:8px; font-size:13px; box-shadow:0 6px 18px rgba(2,6,23,0.12); transform:translateY(-8px); white-space:nowrap; z-index:1000; }
  .tooltip-modern::after{ content:''; position:absolute; left:50%; transform:translateX(-50%); bottom:-6px; border-width:6px 6px 0 6px; border-style:solid; border-color:var(--teal-600) transparent transparent transparent; }



  body { font-family: "Times New Roman"; margin: 30px; background: #fff9e6; }
  h2{margin:0 0 10px;font-size:22px;color:var(--primary-600);text-align:center}
  .topbar{display:flex;justify-content:center;gap:12px;margin-bottom:18px;flex-wrap:wrap}
  .nav-btn{background:var(--primary); color:white; border:none; padding:12px 18px; border-radius:var(--btn-radius); cursor:pointer; font-weight:700; box-shadow:var(--shadow); transition:transform .18s, box-shadow .18s;}

  .btn-add { background: #17a2b8; color: white; }
  .btn-add:hover { background: #138496; }
  .btn-calc { background: #28a745; color: white; }
  .btn-calc:hover { background: #1e7e34; }
  .btn-reset { background: #dc3545; color: white; }
  .btn-reset:hover { background: #b21f2d; }

 h3{margin:0 0 10px;font-size:20px;color:var(--primary-600);text-align:center}
  .topbar{display:flex;justify-content:center;gap:12px;margin-bottom:18px;flex-wrap:wrap}
  .nav-btn{background:var(--primary); color:white; border:none; padding:12px 18px; border-radius:var(--btn-radius); cursor:pointer; font-weight:700; box-shadow:var(--shadow); transition:transform .18s, box-shadow .18s;}

  .btn-add { background: #17a2b8; color: white; }
  .btn-add:hover { background: #138496; }
  .btn-calc { background: #28a745; color: white; }
  .btn-calc:hover { background: #1e7e34; }
  .btn-reset { background: #dc3545; color: white; }
  .btn-reset:hover { background: #b21f2d; }



table { border-collapse: collapse; margin-top: 10px; background: white; border-radius: 10px; overflow: hidden; }
  td, th { border: 1px solid #ccc; padding: 8px 12px; text-align: center; }
  th { background: #aef0e4; }
  input { width: 80px; text-align: center; border: 1px solid #ccc; border-radius: 4px; padding: 4px; }


th:nth-child(1), td:nth-child(1) {
  width: 150px;
}

 footer {
      position: fixed;
      bottom: 0;
      width: 100%;
      text-align: center;
      padding: 10px;
      font-size: 14px;
      background: #f0f0f0;
      color: #333;
      border-top: 1px solid #ccc;

      /* chá»‘ng copy / bÃ´i Ä‘en */
      user-select: none;
      -webkit-user-select: none;
      -moz-user-select: none;
      -ms-user-select: none;
    }


</style>
</head>
<body>

<h1>ğŸ“Š Bá»˜ CÃ”NG Cá»¤ THá»NG KÃŠ</h1>
<p style="font-weight:bold; font-style:italic; color:#16a34a; text-align:center">
    "Trong thá»‘ng kÃª, ngÆ°á»i ta khÃ´ng thá»ƒ Ä‘Æ°a ra má»™t káº¿t luáº­n cháº¯c cháº¯n, nhÆ°ng cÃ³ thá»ƒ Ä‘Æ°a ra má»™t dá»± Ä‘oÃ¡n há»£p lÃ½ dá»±a trÃªn dá»¯ liá»‡u."
  </p>

<div class="topbar">
  <button class="nav-btn" data-view="A" onclick="showView('A')">ğŸ“˜ Máº«u sá»‘ liá»‡u gá»‘c</button>
  <button class="nav-btn" data-view="B" onclick="showView('B')">ğŸ“— Máº«u sá»‘ liá»‡u khÃ´ng ghÃ©p nhÃ³m</button>
  <button class="nav-btn" data-view="C" onclick="showView('C')">ğŸ“™ Máº«u sá»‘ liá»‡u ghÃ©p nhÃ³m</button>
</div>

<!-- ==================== VIEW A: from initial "CÃC Sá» Äáº¶C TRÆ¯NG Cá»¦A MáºªU Sá» LIá»†U Gá»C" (text input) ==================== -->
<section id="view_A" class="view">
  <h3 style="text-align:center">ğŸ“Š CÃC Sá» Äáº¶C TRÆ¯NG Cá»¦A MáºªU Sá» LIá»†U Gá»C</h3>

  <p>Nháº­p dÃ£y sá»‘ liá»‡u cÃ¡ch nhau báº±ng dáº¥u pháº©y hoáº·c khoáº£ng tráº¯ng:</p>
  <input id="A_dataInput" type="text" placeholder="VD: 2, 5, 3, 2, 6, 5, 5, 3" style="width:100%;padding:10px;border-radius:8px;border:1px solid #ccc" />

  <div style="margin-top:12px">
    <button class="btn btn-calc" onclick="A_processData()">ğŸ“ˆ Táº¡o báº£ng & TÃ­nh thá»‘ng kÃª</button>
    <button class="btn btn-reset" onclick="A_resetPage()">ğŸ” LÃ m láº¡i</button>
  </div>

  <div id="A_freqTableDiv"></div>
  <div id="A_result"></div>

</section>

<!-- ==================== VIEW B: non-grouped table values & freqs ==================== -->
<section id="view_B" class="view">
  <h3 style="text-align:center">ğŸ“Š CÃC Sá» Äáº¶C TRÆ¯NG Cá»¦A MáºªU Sá» LIá»†U KHÃ”NG GHÃ‰P NHÃ“M</h3>

   <p>Nháº­p cÃ¡c <b>giÃ¡ trá»‹</b> á»Ÿ dÃ²ng 1 vÃ  <b>táº§n sá»‘</b> á»Ÿ dÃ²ng 2:</p>

  <table id="B_dataTable">
    <tr id="B_valuesRow">
      <th>GiÃ¡ trá»‹ $x_i$</sub></th>
      <td><input type="number"></td>
      <td><input type="number"></td>
      <td><input type="number"></td>
    </tr>
    <tr id="B_freqRow">
      <th>Táº§n sá»‘ $f_i$</sub></th>
      <td><input type="number"></td>
      <td><input type="number"></td>
      <td><input type="number"></td>
    </tr>
  </table>

  <div style="margin-top:14px; display:flex; gap:10px; flex-wrap:wrap">
    <button class="btn btn-add" onclick="B_addColumn()">â• ThÃªm cá»™t</button>
    <button class="btn btn-add" onclick="B_removeColumn()">âŒ XÃ³a cá»™t</button>
    <button class="btn btn-calc" onclick="B_calcStats()">ğŸ“ˆ TÃ­nh thá»‘ng kÃª</button>
    <button class="btn btn-reset" onclick="B_resetTable()">ğŸ” LÃ m láº¡i</button>
  </div>

  <div id="B_result"></div>
</section>

<!-- ==================== VIEW C: grouped data (classes) ==================== -->
<section id="view_C" class="view">
  <h3 style="text-align:center">ğŸ“Š CÃC Sá» Äáº¶C TRUNG Cá»¦A MáºªU Sá» LIá»†U GHÃ‰P NHÃ“M</h3>
  <p>Nháº­p nhÃ³m (vÃ­ dá»¥ nhÃ³m [1;2) thÃ¬ nháº­p <b>1-2</b>) á»Ÿ dÃ²ng 1, <span style="color:red">Sá»‘ Ã¢m Ä‘Æ°á»£c viáº¿t trong dáº¥u (). VÃ­ dá»¥ [-2;1) thÃ¬ nháº­p (-2)-1</span> vÃ  <b>táº§n sá»‘</b> á»Ÿ dÃ²ng 3:</p>


  <table id="C_dataTable">
    <tr id="C_row-class"><th>NhÃ³m [a;b)</th></tr>
    <tr id="C_row-mid"><th>GiÃ¡ trá»‹ Ä‘áº¡i diá»‡n $m_i$</sub></th></tr>
    <tr id="C_row-freq"><th>Táº§n sá»‘ $f_i$</sub></th></tr>
  </table>

  <div style="margin-top:12px; display:flex; gap:10px; flex-wrap:wrap">
    <button class="btn btn-add" onclick="C_addColumn()">â• ThÃªm nhÃ³m</button>
    <button class="btn btn-add" onclick="C_removeColumn()">âŒ XÃ³a nhÃ³m</button>
    <button class="btn btn-calc" onclick="C_processGrouped()">ğŸ“ˆ TÃ­nh thá»‘ng kÃª</button>
    <button class="btn btn-reset" onclick="C_resetPage()">ğŸ” LÃ m láº¡i</button>
  </div>

  <div id="C_result"></div>
</section>

<!-- MathJax loaded once -->
<script>
  window.MathJax = { tex: { inlineMath: [['\\(','\\)'], ['$', '$']] }, svg: { fontCache: 'global' } };
</script>
<script async src="https://cdn.jsdelivr.net/npm/mathjax@3/es5/tex-svg.js"></script>

<script>
/* ================= view switcher ================= */
function showView(which){
  document.querySelectorAll('.view').forEach(v=> v.classList.remove('active'));
  const s = document.getElementById('view_' + which);
  if(s) s.classList.add('active');
  // scroll to top of view
  s.scrollIntoView({behavior:'smooth'});
}
// default open A
showView('A');

/* =============== VIEW A functions (text input -> expanded array) =============== */
function A_resetPage(){
  document.getElementById('A_dataInput').value='';
  document.getElementById('A_freqTableDiv').innerHTML='';
  document.getElementById('A_result').innerHTML='';
}
function A_processData(){
  const input = document.getElementById('A_dataInput').value.trim();
  if(!input) return alert("Vui lÃ²ng nháº­p dá»¯ liá»‡u!");
  let values = input.split(/[\s,]+/).map(Number).filter(x=>!isNaN(x));
  if(values.length===0) return alert("Dá»¯ liá»‡u khÃ´ng há»£p lá»‡!");
  // frequency map
  const freqMap = {};
  values.forEach(v=> freqMap[v]=(freqMap[v]||0)+1);
  const uniqueValues = Object.keys(freqMap).map(Number).sort((a,b)=>a-b);
  let tableHTML = '<h3>Báº£ng táº§n sá»‘</h3><table><tr><th>GiÃ¡ trá»‹ $x_i$</th>';
  uniqueValues.forEach(v=> tableHTML += `<td>${v}</td>`); tableHTML+='</tr><tr><th>táº§n sá»‘ $f_i$</th>';
  uniqueValues.forEach(v=> tableHTML += `<td>${freqMap[v]}</td>`); tableHTML+='</tr></table>';
  document.getElementById('A_freqTableDiv').innerHTML = tableHTML;

  const n = values.length;
  const mean = values.reduce((s,v)=>s+v,0)/n;
  const sorted = [...values].sort((a,b)=>a-b);
  const median = n%2===1 ? sorted[(n-1)/2] : (sorted[n/2-1]+sorted[n/2])/2;
  let lower = sorted.slice(0, Math.floor(n/2));
  let upper = sorted.slice(Math.ceil(n/2));
  const medianOfArray = arr => arr.length===0?NaN: arr.length%2===1? arr[(arr.length-1)/2]:(arr[arr.length/2-1]+arr[arr.length/2])/2;
  const Q1 = medianOfArray(lower);
  const Q3 = medianOfArray(upper);
  const frequencies = Object.values(freqMap);
  const allEqual = frequencies.every(v => v === frequencies[0]);
  let modeStr = "";
  if(allEqual) modeStr = "KhÃ´ng cÃ³ má»‘t";
  else {
    const maxF = Math.max(...frequencies);
    const modes = Object.keys(freqMap).filter(k => freqMap[k] === maxF).map(Number);
    modeStr = modes.join(", ");
  }
  const variance = values.reduce((s,v)=>s+(v-mean)**2,0)/n;
  const stddev = Math.sqrt(variance);
  const IQR = Q3-Q1;
  const lowerBound = Q1-1.5*IQR;
  const upperBound = Q3+1.5*IQR;
  const outliers = sorted.filter(v=>v<lowerBound || v>upperBound);
  const outlierText = outliers.length>0 ? outliers.join(', ') : 'KhÃ´ng cÃ³';

  
 
const resultHTML = `
  <div class="container-cols">
    <div class="card formula">
      <h3>ğŸ“˜ CÃ´ng thá»©c</h3>
      
      <p><b>ğŸ“ŒTrung bÃ¬nh cá»™ng:</b> \\(\\bar{x} = \\dfrac{\\sum x_i}{n}\\)</p>
      <p><b>ğŸ“ŒTrung vá»‹ :</b> \\(
        Me = \\begin{cases} 
        x_{(n+1)/2}, & n \\text{ láº»} \\\\ 
        \\dfrac{x_{n/2} + x_{n/2+1}}{2}, & n \\text{ cháºµn} 
        \\end{cases} \\)</p>
      <p><b>ğŸ“ŒTá»© phÃ¢n vá»‹:</b> $Q_1, Q_3$ lÃ  trung vá»‹ cá»§a ná»­a dÆ°á»›i vÃ  ná»­a trÃªn</p>
      <p><b>ğŸ“ŒMá»‘t:</b> giÃ¡ trá»‹ xuáº¥t hiá»‡n nhiá»u nháº¥t</p>
      <p><b>ğŸ“ŒPhÆ°Æ¡ng sai:</b> \\(\\sigma^2 = \\dfrac{\\sum (x_i-\\bar{x})^2}{n}\\)</p>
      <p><b>ğŸ“ŒÄá»™ lá»‡ch chuáº©n:</b> \\(\\sigma = \\sqrt{\\sigma^2}\\)</p>
      <p><b>ğŸ“ŒGiÃ¡ trá»‹ báº¥t thÆ°á»ng:</b> ngoÃ i Ä‘oáº¡n $[\Q_1-1.5 Î”Q; \Q_3+1.5.Î”Q]$</p>
    </div> 
    <div class="output">

 <h3>ğŸ“˜ Káº¿t quáº£</h3>

      <p><b>ğŸ‘‰Sá»‘ giÃ¡ trá»‹ $n=$</b> ${n}</p>
      <p><b>ğŸ‘‰Trung bÃ¬nh cá»™ng $\\bar{x}Ì„=$</b> ${mean.toFixed(3)}</p>
      <p><b>ğŸ‘‰Trung vá»‹ $M_e=Q_2=$</b> ${median}</p>
      <p><b>ğŸ‘‰Tá»© phÃ¢n vá»‹:</b> $Q_1 =$ ${Q1}, $Q_3$ = ${Q3}</p>
      <p><b>ğŸ‘‰Má»‘t $M_o=$</b> ${modeStr}</p>
      <p><b>ğŸ‘‰PhÆ°Æ¡ng sai $\\sigma^2=$</b> ${variance.toFixed(3)}</p>
      <p><b>ğŸ‘‰Äá»™ lá»‡ch chuáº©n $\\sigma=$</b> ${stddev.toFixed(3)}</p>
      <p><b>ğŸ‘‰GiÃ¡ trá»‹ báº¥t thÆ°á»ng:</b> ${outlierText}</p>
    </div>
  </div>
  `;

   
  document.getElementById('A_result').innerHTML = resultHTML;

  setTimeout(()=>{ document.querySelector('#view_A .formula')?.classList.add('show'); document.querySelector('#view_A .output')?.classList.add('show'); },50);
  if(window.MathJax) MathJax.typesetPromise();
}

/* =============== VIEW B functions (non-grouped) =============== */
function B_addColumn(){
  const vRow = document.getElementById('B_valuesRow');
  const fRow = document.getElementById('B_freqRow');
  const vCell = document.createElement('td');
  const fCell = document.createElement('td');
  vCell.innerHTML = '<input type="number">';
  fCell.innerHTML = '<input type="number">';
  vRow.appendChild(vCell);
  fRow.appendChild(fCell);
}
function B_removeColumn(){
  const vRow = document.getElementById('B_valuesRow');
  const fRow = document.getElementById('B_freqRow');
  const count = vRow.children.length;
  if(count > 2){
    vRow.removeChild(vRow.lastElementChild);
    fRow.removeChild(fRow.lastElementChild);
  } else alert("KhÃ´ng thá»ƒ xÃ³a thÃªm! Báº£ng pháº£i cÃ³ Ã­t nháº¥t 1 cá»™t dá»¯ liá»‡u.");
}
function B_resetTable(){
  document.getElementById('B_dataTable').innerHTML = `
    <tr id="B_valuesRow"><th>GiÃ¡ trá»‹  x<sub>i</th><td><input type="number"></td><td><input type="number"></td><td><input type="number"></td></tr>
    <tr id="B_freqRow"><th>Táº§n sá»‘ f<sub>i</th><td><input type="number"></td><td><input type="number"></td><td><input type="number"></td></tr>
  `;
  document.getElementById('B_result').innerHTML = "";
}




function B_calcStats(){
  try{
    const valueInputs = [...document.querySelectorAll('#B_valuesRow input')];
    const freqInputs  = [...document.querySelectorAll('#B_freqRow input')];
    const values = valueInputs.map(inp => parseFloat(inp.value));
    const freqs  = freqInputs.map(inp => parseFloat(inp.value));

    // validation
    for (let i = 0; i < values.length; i++){
      if (isNaN(values[i])) { valueInputs[i].classList.add('shake'); valueInputs[i].focus(); alert("âŒ Lá»—i: GiÃ¡ trá»‹ pháº£i lÃ  sá»‘!"); setTimeout(()=>valueInputs[i].classList.remove('shake'),400); return;}
    }
    for (let i = 0; i < freqs.length; i++){
      if (isNaN(freqs[i]) || freqs[i] < 0) { freqInputs[i].classList.add('shake'); freqInputs[i].focus(); alert("âŒ Lá»—i: Táº§n sá»‘ pháº£i lÃ  sá»‘ vÃ  â‰¥ 0!"); setTimeout(()=>freqInputs[i].classList.remove('shake'),400); return;}
    }
    for (let i = 1; i < values.length; i++){
      if (values[i] <= values[i-1]) { valueInputs[i].classList.add('shake'); valueInputs[i].focus(); alert("âŒ Lá»—i: GiÃ¡ trá»‹ pháº£i tÄƒng dáº§n (xâ‚ < xâ‚‚ < â€¦)!"); setTimeout(()=>valueInputs[i].classList.remove('shake'),400); return;}
    }

    const data = values.map((x,i)=>({x,f:freqs[i]})).filter(o=>typeof o.x==='number' && typeof o.f==='number');
    if(data.length===0){ alert("Vui lÃ²ng nháº­p Ä‘á»§ giÃ¡ trá»‹ vÃ  táº§n sá»‘ há»£p lá»‡!"); return; }

    const n = data.reduce((s,o)=>s+o.f,0);
    const mean = data.reduce((s,o)=>s+o.x*o.f,0)/n;

    const expanded = [];
    data.sort((a,b)=>a.x-b.x).forEach(o=>{ for(let k=0;k<o.f;k++) expanded.push(o.x); });
    expanded.sort((a,b)=>a-b);

    function medianOfArray(arr){
      const m=arr.length; if(m===0) return NaN;
      if(m%2===1) return arr[(m-1)/2]; return (arr[m/2-1]+arr[m/2])/2;
    }
    const median = medianOfArray(expanded);

    let lowerHalf, upperHalf;
    if(n%2===0){ lowerHalf = expanded.slice(0,n/2); upperHalf = expanded.slice(n/2);}
    else { lowerHalf = expanded.slice(0,Math.floor(n/2)); upperHalf = expanded.slice(Math.floor(n/2)+1); }
    const Q1 = medianOfArray(lowerHalf); const Q3 = medianOfArray(upperHalf);

    const variance = data.reduce((s,o)=>s+o.f*Math.pow(o.x-mean,2),0)/n;
    const stddev = Math.sqrt(variance);

    // mode logic
    const freqValues = data.map(o=>o.f);
    const allEqual = freqValues.every(f=>f===freqValues[0]);
    let modeText = 'KhÃ´ng cÃ³ dá»¯ liá»‡u';
    if(freqValues.length===0) modeText='KhÃ´ng cÃ³ dá»¯ liá»‡u';
    else if(allEqual) modeText='KhÃ´ng cÃ³ má»‘t';
    else { const maxF = Math.max(...freqValues); const modes = data.filter(o=>o.f===maxF).map(o=>o.x); modeText = modes.length===1?String(modes[0]):modes.join(', '); }

    const IQR = Q3 - Q1;
    const LB = Q1 - 1.5*IQR; const UB = Q3 + 1.5*IQR;
    const outliers = expanded.filter(v=>v<LB || v>UB);

    document.getElementById('B_result').innerHTML = `
      <div class="container-cols">
        <div class="card formula">
          <h3>ğŸ“˜ CÃ´ng thá»©c</h3>
          <p><b>ğŸ“ŒTrung bÃ¬nh cá»™ng:</b> \\( \\bar{x} = \\dfrac{\\sum f_i x_i}{\\sum f_i} \\)</p>
          <p><b>ğŸ“ŒTrung vá»‹:</b> \\( Me = \\begin{cases} x_{\\frac{n+1}{2}}, & n \\text{ láº»} \\\\ \\dfrac{x_{\\frac{n}{2}} + x_{\\frac{n}{2}+1}}{2}, & n \\text{ cháºµn} \\end{cases} \\)</p>
          <p><b>ğŸ“ŒTá»© phÃ¢n vá»‹:</b> \\( Q_1, Q_3 \\) lÃ  trung vá»‹ cá»§a ná»­a dÆ°á»›i vÃ  ná»­a trÃªn máº«u</p>
          <p><b>ğŸ“ŒMá»‘t:</b> GiÃ¡ trá»‹ cÃ³ táº§n sá»‘ lá»›n nháº¥t</p>
          <p><b>ğŸ“ŒPhÆ°Æ¡ng sai:</b> \\( \\sigma^2 = \\dfrac{\\sum f_i (x_i - \\bar{x})^2}{\\sum f_i} \\)</p>
<p><b>ğŸ“ŒÄá»™ lá»‡ch chuáº©n:</b> \\( \\sigma = \\sqrt{\\sigma^2} \\)</p>

<p><b>ğŸ“Œ GiÃ¡ trá»‹ báº¥t thÆ°á»ng:</b>  
  CÃ¡c giÃ¡ trá»‹ thá»a mÃ£n:  
  \\( x < Q_1 - 1.5 \\cdot (Q_3 - Q_1) \\)  
   hoáº·c  
  \\( x > Q_3 + 1.5 \\cdot (Q_3 - Q_1) \\)
</p>

  </div>
        <div class="card output">
          <h3>ğŸ§® Káº¿t quáº£</h3>
          <p><b>ğŸ‘‰Sá»‘ giÃ¡ trá»‹: $n=$</b> ${n}</p>
          <p><b>ğŸ‘‰Trung bÃ¬nh cá»™ng: $\\bar{x}=$</b> ${mean.toFixed(3)}</p>
          <p><b>ğŸ‘‰Trung vá»‹ :$M_e =$</b> ${median}</p>
          <p><b>ğŸ‘‰Tá»© phÃ¢n vá»‹:</b> $Q_1 =$</b> ${isNaN(Q1)?'â€”':Q1}, $Q_2 =$ ${median}, <b>$Q_3=$</b> ${isNaN(Q3)?'â€”':Q3}</p>
          <p><b>ğŸ‘‰Má»‘t :$M_0$ =</b> ${modeText}</p>
          <p><b>ğŸ‘‰PhÆ°Æ¡ng sai $\\sigma^2=$</b> ${variance.toFixed(3)}</p>
          <p><b>ğŸ‘‰Äá»™ lá»‡ch chuáº©n $\\sigma=$</b> ${stddev.toFixed(3)}</p>
          <p><b>ğŸ‘‰GiÃ¡ trá»‹ báº¥t thÆ°á»ng:</b> ${outliers.length?outliers.join(', '):'KhÃ´ng cÃ³'}</p>
        
</div>
      </div>
    `;
    if(window.MathJax) MathJax.typesetPromise();
  } catch(err){
    console.error(err); alert('Lá»—i khi tÃ­nh toÃ¡n â€” kiá»ƒm tra console.');
  }
}

/* =============== VIEW C functions (grouped) =============== */
/* helpers: add default 3 columns on load */
(function C_init(){
  // create 3 default columns
  const rowClass=document.getElementById('C_row-class');
  if(rowClass && rowClass.children.length===1){
    C_addColumn("10-20",5);
    C_addColumn("20-30",8);
    C_addColumn("30-40",6);
  }
})();
function C_addColumn(defaultGroup="", defaultFreq=""){
  const rowClass=document.getElementById('C_row-class');
  const rowMid=document.getElementById('C_row-mid');
  const rowFreq=document.getElementById('C_row-freq');

  const tdClass=document.createElement('td');
  const tdMid=document.createElement('td');
  const tdFreq=document.createElement('td');

  tdClass.style.position = "relative";
  tdFreq.style.position = "relative";

  const inputClass=document.createElement('input');
  inputClass.type='text';
  inputClass.placeholder='a-b';
  if(defaultGroup) inputClass.value=defaultGroup;
  inputClass.oninput=C_updateMidpoints;
  tdClass.appendChild(inputClass);

  tdMid.textContent='â€“';

  const inputFreq=document.createElement('input');
  inputFreq.type='number';
  inputFreq.min='0';
  inputFreq.step='1';
  if(defaultFreq) inputFreq.value=defaultFreq;
  tdFreq.appendChild(inputFreq);

  rowClass.appendChild(tdClass);
  rowMid.appendChild(tdMid);
  rowFreq.appendChild(tdFreq);

  tdClass.classList.add('show'); tdMid.classList.add('show'); tdFreq.classList.add('show');
}
function C_removeColumn(){
  const rowClass=document.getElementById('C_row-class');
  if(rowClass.children.length <= 2) return; // khÃ´ng xÃ³a háº¿t

  const tdClass = rowClass.lastElementChild;
  const tdMid = document.getElementById('C_row-mid').lastElementChild;
  const tdFreq = document.getElementById('C_row-freq').lastElementChild;

  tdClass.remove(); tdMid.remove(); tdFreq.remove();
}
function C_updateMidpoints() {
  const classInputs = document.querySelectorAll('#C_row-class input');
  const midCells = document.querySelectorAll('#C_row-mid td:not(:first-child)');

  // regex: báº¯t cáº£ chuá»—i dáº¡ng: (a) - (b) hoáº·c a - b
  // group 1 = a, group 3 = b
  const rangeRE = /^\s*\(?\s*([+-]?\d+(?:\.\d+)?)\s*\)?\s*-\s*\(?\s*([+-]?\d+(?:\.\d+)?)\s*\)?\s*$/;

  classInputs.forEach((inp, i) => {
    let val = inp.value.trim();

    // chuáº©n hÃ³a cÃ¡c dáº¥u trá»« láº¡ thÃ nh '-' (khÃ´ng xÃ³a ngoáº·c)
    val = val.replace(/[âˆ’â€“â€”]/g, "-");

    const m = val.match(rangeRE);

    if (m) {
      const a = Number(m[1]);
      const b = Number(m[2]);
      if (!isNaN(a) && !isNaN(b)) {
        midCells[i].textContent = ((a + b) / 2).toFixed(2);
        return;
      }
    }

    // náº¿u khÃ´ng khá»›p Ä‘á»‹nh dáº¡ng range, thá»­ láº¥y hai sá»‘ báº¥t ká»³ (fallback)
    const nums = val.match(/[+-]?\d+(?:\.\d+)?/g);
    if (nums && nums.length >= 2) {
      const a = Number(nums[0]), b = Number(nums[1]);
      if (!isNaN(a) && !isNaN(b)) {
        midCells[i].textContent = ((a + b) / 2).toFixed(2);
        return;
      }
    }

    // khÃ´ng Ä‘á»§ dá»¯ liá»‡u -> hiá»ƒn thá»‹ dáº¥u gáº¡ch
    midCells[i].textContent = "â€“";
  });
}

function C_resetPage(){
  document.getElementById('C_dataTable').innerHTML = `
    <tr id="C_row-class"><th>NhÃ³m [a;b)</th></tr>
    <tr id="C_row-mid"><th>GiÃ¡ trá»‹ Ä‘áº¡i diá»‡n m<sub>i</th></tr>
    <tr id="C_row-freq"><th>Táº§n sá»‘ f<sub>i </th></tr>
  `;
  document.getElementById('C_result').innerHTML = '';
  C_addColumn("10-20",5); C_addColumn("20-30",8); C_addColumn("30-40",6);
}
function C_processGrouped(){
  try{
    const classInputs=document.querySelectorAll('#C_row-class input');
    const freqInputs=document.querySelectorAll('#C_row-freq input');
    const classes = [], freqs=[];
    let valid=true;
    
    classInputs.forEach(inp=>{
  const v = inp.value.trim().replace(/[âˆ’â€“â€”]/g, "-"); // chuáº©n hÃ³a dáº¥u trá»«
  const m = v.match(/^\s*\(?\s*([+-]?\d+(?:\.\d+)?)\s*\)?\s*-\s*\(?\s*([+-]?\d+(?:\.\d+)?)\s*\)?\s*$/);
  if(!m) { 
    inp.classList.add('shake'); 
    valid=false; 
    setTimeout(()=>inp.classList.remove('shake'),360); 
  } else {
    const a = Number(m[1]), b = Number(m[2]);
    classes.push({min:a,max:b});
  }
});

  
  
    
    
    freqInputs.forEach(inp=>{
      const v=inp.value.trim();
      if(v===""|| isNaN(Number(v)) || Number(v)<0){ inp.classList.add('shake'); valid=false; setTimeout(()=>inp.classList.remove('shake'),360); }
      else freqs.push(Number(inp.value));
    });
    if(!valid){ alert("Dá»¯ liá»‡u chÆ°a há»£p lá»‡!"); return; }
    const mids = classes.map(c=>(c.min+c.max)/2);
    const n = freqs.reduce((a,b)=>a+b,0);
    if(n===0){ alert("Tá»•ng táº§n sá»‘ = 0!"); return; }
    const mean = mids.reduce((s,m,i)=>s + m*freqs[i], 0)/n;
    // cumulative frequency
    const cf = []; freqs.reduce((acc,f,i)=> (cf[i]=acc+f, acc+f), 0);
    // median
    const medianPos = n/2;
    const medIdx = cf.findIndex(c=>c>=medianPos);
    const Lm = classes[medIdx].min;
    const Fm = freqs[medIdx];
    const cfPrev = medIdx>0?cf[medIdx-1]:0;
    const h = classes[medIdx].max - classes[medIdx].min;
    const median = Lm + ((medianPos - cfPrev)/Fm)*h;
    // mode (grouped)
    const idxMo = freqs.indexOf(Math.max(...freqs));
    const f1 = freqs[idxMo];
    const f0 = idxMo>0?freqs[idxMo-1]:0;
    const f2 = idxMo<freqs.length-1?freqs[idxMo+1]:0;
    const Lmo = classes[idxMo].min;
    const mode = Lmo + ((f1 - f0)/(2*f1 - f0 - f2))*h;
    // variance & std (use midpoints)
    const variance = mids.reduce((s,m,i)=> s + freqs[i]*(m-mean)**2, 0)/n;
    const stddev = Math.sqrt(variance);
    // Q1, Q3
    const q1Pos = n/4, q3Pos = 3*n/4;
    const q1Idx = cf.findIndex(c=>c>=q1Pos);
    const q3Idx = cf.findIndex(c=>c>=q3Pos);
    const Lq1 = classes[q1Idx].min, Fq1 = freqs[q1Idx], cf1Prev = q1Idx>0?cf[q1Idx-1]:0;
    const Lq3 = classes[q3Idx].min, Fq3 = freqs[q3Idx], cf3Prev = q3Idx>0?cf[q3Idx-1]:0;
    const Q1 = Lq1 + ((q1Pos - cf1Prev)/Fq1)*h;
    const Q3 = Lq3 + ((q3Pos - cf3Prev)/Fq3)*h;
    const IQR = Q3 - Q1;
    const lowerBound = Q1 - 1.5*IQR, upperBound = Q3 + 1.5*IQR;
    const outliers = mids.filter(m=>m<lowerBound || m>upperBound);
    // display
    document.getElementById('C_result').innerHTML = `
      
<div class="container-cols">
        <div class="card formula">
                   
<h3>ğŸ“˜ CÃ´ng thá»©c tÃ­nh toÃ¡n</h3>
      <p><b>ğŸ“ŒGiÃ¡ trá»‹ Ä‘áº¡i diá»‡n:</b> $\m_i = \\frac{{x_i}+x_{i+1}}{2}$</p>
      <p><b>ğŸ“ŒTrung bÃ¬nh:</b> \\( \\bar{x} = \\frac{\\sum f_i m_i}{\\sum f_i} \\)</p>
      <p><b>ğŸ“ŒTrung vá»‹:</b> \\( Me = L + \\frac{\\frac{n}{2}-F_{trÆ°á»›c}}{f_{Me}}h \\)</p>
      <p><b>ğŸ“ŒMá»‘t:</b> $\M_0 = a_i+\\frac{m_i-m_{i-1}}{(m_i-m_{i-1})+(m_i-m_{i+1})}(a_{i+1}-\a_{i})$, vá»›i $\M_0 \\in [\a_i;\a_{i+1})$</p>
      <p><b>ğŸ“ŒPhÆ°Æ¡ng sai:</b> \\( \\sigma^2 = \\frac{\\sum f_i (m_i - \\bar{x})^2}{n} \\)</p>
      <p><b>ğŸ“ŒÄá»™ lá»‡ch chuáº©n:</b> \\( \\sigma = \\sqrt{\\sigma^2} \\)</p>
      <p><b>ğŸ“ŒTá»© phÃ¢n vá»‹:</b> $\Q_r = a_i+\\frac{\\frac{nr}{4}-(m_1+m_2+...+m_{i-1})}{m_i}(\a_{i+1}-\a_{i})$, vá»›i $\Q_r \\in [\a_i;\a_{i+1})$</p>
      <p><b>ğŸ“ŒGiÃ¡ trá»‹ báº¥t thÆ°á»ng:</b> ngoÃ i Ä‘oáº¡n \\([Q_1-1.5Î”Q, Q_3+1.5Î”Q] \\)</p>
    </div>

        <div class="card output">
          <h3>ğŸ§® Káº¿t quáº£</h3>
          <p><b>ğŸ‘‰Cá»¡ máº«u: $n=$</b> ${n}</p>
          <p><b>ğŸ‘‰Trung bÃ¬nh cá»™ng:\\(\\bar{x}=\\)</b> ${mean.toFixed(3)}</p>
          <p><b>ğŸ‘‰Trung vá»‹: $M_e=$</b> ${median.toFixed(3)}</p>
          <p><b>ğŸ‘‰Má»‘t: $Mo=$</b> ${mode.toFixed(3)}</p>
          <p><b>ğŸ‘‰Tá»© phÃ¢n vá»‹:$Q_1 =$</b> ${Q1.toFixed(3)},  $Q_2$ = ${median.toFixed(3)}, 
 <b> $Q_3$ =</b> ${Q3.toFixed(3)}</p>
          <p><b>ğŸ‘‰PhÆ°Æ¡ng sai: $\\sigma^2=$</b> ${variance.toFixed(3)}</p>
          <p><b>ğŸ‘‰Äá»™ lá»‡ch chuáº©n: $\\sigma=$</b> ${stddev.toFixed(3)}</p>
          <p><b>ğŸ‘‰GiÃ¡ trá»‹ báº¥t thÆ°á»ng:</b> ${outliers.length?outliers.join(', '):'KhÃ´ng cÃ³'}</p>
       

 </div>
     </div> 
    `;
    if(window.MathJax) MathJax.typesetPromise();
  } catch(err){
    console.error(err); alert('Lá»—i khi xá»­ lÃ½ dá»¯ liá»‡u ghÃ©p nhÃ³m.');
  }
}

/* End of scripts */
</script>

<meta charset="UTF-8">
<footer id="copyright"></footer>

<script>
  // Base64 Ä‘Ãºng (chá»¯ QuÃ½)
  const b64Copyright = "TMOqIFbEg24gUXXDvSwgVEhQVCBCw6xuaCBTxqFuLCBRdeG6o25nIE5nw6NpK0dQVA==";

  const bytes = Uint8Array.from(atob(b64Copyright), c => c.charCodeAt(0));
  const text  = new TextDecoder("utf-8").decode(bytes);

  // Kiá»ƒm tra nhanh trÃªn console: pháº£i in Ä‘Ãºng "Â© 2025 LÃª VÄƒn QuÃ½+GPT. All rights reserved."
  console.log(text);

  document.getElementById("copyright").textContent = text;

  // (tuá»³ chá»n) cháº·n chuá»™t pháº£i & Ctrl+C nhÆ° báº¡n Ä‘Ã£ lÃ m
  document.addEventListener("contextmenu", e => e.preventDefault());
  document.addEventListener("keydown", e => {
    if (e.ctrlKey && e.key.toLowerCase() === "c") {
      e.preventDefault();
      alert("!");
    }
  });
</script>

</body>
</html>










